App As appinfo:
    BackEnabled: =false
    OnStart: |-
        =Set(
            _varLoading,
            true
        );
        Set(
            _varJaMostrouDicaDestaque,
            false
        );
        Set(
            _varAtivo_T_WasEdited,
            false
        );
        Set(
            _varLoading_T,
            true
        );
        Set(
            _varLoading_G,
            true
        );
        Refresh(ativos_AT_v3);
        //Divide a busca dos ativos em subcoleções provisórias que rodam no servidor simultaneamente, otimizando o processamento
        Concurrent(
            ClearCollect(
                colAtivos_T_provisorio_1,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 1 && ID_ESPELHO < 2000
                )
            ),
            ClearCollect(
                colAtivos_T_provisorio_2,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 2000 && ID_ESPELHO < 4000
                )
            ),
            ClearCollect(
                colAtivos_T_provisorio_3,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 4000 && ID_ESPELHO < 6000
                )
            ),
            ClearCollect(
                colAtivos_T_provisorio_4,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 6000 && ID_ESPELHO < 8000
                )
            ),
            ClearCollect(
                colAtivos_T_provisorio_5,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 8000 && ID_ESPELHO < 10000
                )
            ),
            ClearCollect(
                colAtivos_T_provisorio_6,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 10000 && ID_ESPELHO < 12000
                )
            ),
            ClearCollect(
                colAtivos_T_provisorio_7,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 12000 && ID_ESPELHO < 14000
                )
            ),
            ClearCollect(
                colAtivos_T_provisorio_8,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 14000 && ID_ESPELHO < 16000
                )
            ),
            ClearCollect(
                colAtivos_T_provisorio_9,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 16000 && ID_ESPELHO < 18000
                )
            ),
            ClearCollect(
                colAtivos_T_provisorio_10,
                Filter(
                    ativos_AT_v3,
                    ID_ESPELHO >= 18000 && ID_ESPELHO < 20000
                )
            )
        );
        //Junta as coleções em colAtivos_T
        ClearCollect(
            colAtivos_T,
            colAtivos_T_provisorio_1,
            colAtivos_T_provisorio_2,
            colAtivos_T_provisorio_3,
            colAtivos_T_provisorio_4,
            colAtivos_T_provisorio_5,
            colAtivos_T_provisorio_6,
            colAtivos_T_provisorio_7,
            colAtivos_T_provisorio_8,
            colAtivos_T_provisorio_9,
            colAtivos_T_provisorio_10
        );
        Set(
            _varLoading_T,
            false
        );
        Refresh(ativos_AG_v1);
        //Divide a busca dos ativos em subcoleções provisórias que rodam no servidor simultaneamente, otimizando o processamento
        Concurrent(
            ClearCollect(
                colAtivos_G_provisorio_1,
                Filter(
                    ativos_AG_v1,
                    ID_ESPELHO >= 1 && ID_ESPELHO < 2000
                )
            ),
            ClearCollect(
                colAtivos_G_provisorio_2,
                Filter(
                    ativos_AG_v1,
                    ID_ESPELHO >= 2000 && ID_ESPELHO < 4000
                )
            ),
            ClearCollect(
                colAtivos_G_provisorio_3,
                Filter(
                    ativos_AG_v1,
                    ID_ESPELHO >= 4000 && ID_ESPELHO < 6000
                )
            ),
            ClearCollect(
                colAtivos_G_provisorio_4,
                Filter(
                    ativos_AG_v1,
                    ID_ESPELHO >= 6000 && ID_ESPELHO < 8000
                )
            ),
            ClearCollect(
                colAtivos_G_provisorio_5,
                Filter(
                    ativos_AG_v1,
                    ID_ESPELHO >= 8000 && ID_ESPELHO < 10000
                )
            ),
            ClearCollect(
                colAtivos_G_provisorio_6,
                Filter(
                    ativos_AG_v1,
                    ID_ESPELHO >= 10000 && ID_ESPELHO < 12000
                )
            ),
            ClearCollect(
                colAtivos_G_provisorio_7,
                Filter(
                    ativos_AG_v1,
                    ID_ESPELHO >= 12000 && ID_ESPELHO < 14000
                )
            ),
            ClearCollect(
                colAtivos_G_provisorio_8,
                Filter(
                    ativos_AG_v1,
                    ID_ESPELHO >= 14000 && ID_ESPELHO < 16000
                )
            )
        );
        //Junta todas as coleções em colAtivos_G
        ClearCollect(
            colAtivos_G,
            colAtivos_G_provisorio_1,
            colAtivos_G_provisorio_2,
            colAtivos_G_provisorio_3,
            colAtivos_G_provisorio_4,
            colAtivos_G_provisorio_5,
            colAtivos_G_provisorio_6,
            colAtivos_G_provisorio_7,
            colAtivos_G_provisorio_8
        );
        Set(
            _varLoading_G,
            false
        );
        //Limpa as coleções provisórias de colAtivos_T simultaneamente
        Concurrent(
            Clear(colAtivos_T_provisorio_1),
            Clear(colAtivos_T_provisorio_2),
            Clear(colAtivos_T_provisorio_3),
            Clear(colAtivos_T_provisorio_4),
            Clear(colAtivos_T_provisorio_5),
            Clear(colAtivos_T_provisorio_6),
            Clear(colAtivos_T_provisorio_7),
            Clear(colAtivos_T_provisorio_8),
            Clear(colAtivos_T_provisorio_9),
            Clear(colAtivos_T_provisorio_10)
        );
        //Limpa coleções provisórias de colAtivos_G simultaneamente
        Concurrent(
            Clear(colAtivos_G_provisorio_1),
            Clear(colAtivos_G_provisorio_2),
            Clear(colAtivos_G_provisorio_3),
            Clear(colAtivos_G_provisorio_4),
            Clear(colAtivos_G_provisorio_5),
            Clear(colAtivos_G_provisorio_6),
            Clear(colAtivos_G_provisorio_7),
            Clear(colAtivos_G_provisorio_8)
        );
        ClearCollect(
            colFases,
            "VM",
            "AZ",
            "BR",
            "RM",
            "TR"
        );
        Refresh(modelos_ativos_v3);
        ClearCollect(
            colModelosEquipamentos,
            Filter(
                modelos_ativos_v3,
                ID_ESPELHO >= 1 && ID_ESPELHO < 2000
            )
        );
        Collect(
            colModelosEquipamentos,
            Filter(
                modelos_ativos_v3,
                ID_ESPELHO >= 2000 && ID_ESPELHO < 3000
            )
        );
        Set(
            _varUserIsAdmin,
            !IsBlank(
                LookUp(
                    users_admin_adore_app,
                    Usuario.Email = User().Email,
                    Usuario
                )
            )
        );
        Set(
            _varLoading,
            false
        );
    StartScreen: =SplashScreen

